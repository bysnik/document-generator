<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>–ü–∞–∫–µ—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 800px; 
            margin: 20px auto; 
            padding: 20px; 
            background: #f5f7fa;
        }
        .form-container { 
            background: white; 
            padding: 40px; 
            border-radius: 12px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.08); 
            text-align: center; 
        }
        h1 { 
            color: #28a745; 
            margin-bottom: 30px; 
            font-size: 28px; 
        }
        
        /* –û–±–ª–∞—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ */
        .upload-area { 
            border: 3px dashed #28a745; 
            padding: 60px; 
            border-radius: 12px; 
            background: #f8fff8; 
            margin: 30px 0; 
            cursor: pointer; 
            transition: all 0.3s;
        }
        .upload-area:hover { 
            background: #f0fff0; 
            border-color: #218838; 
        }
        
        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ */
        .file-info { 
            background: #e7f3ff; 
            padding: 25px; 
            border-radius: 10px; 
            margin: 25px 0; 
            text-align: left; 
            display: none; 
            border-left: 4px solid #3498db;
        }
        .file-info h3 { 
            margin: 0 0 15px 0; 
            color: #2c3e50; 
            font-size: 20px; 
            display: flex;
            align-items: center;
        }
        .file-info h3 i { 
            margin-right: 10px; 
            color: #27ae60; 
            font-size: 24px;
        }
        .file-info p { 
            margin: 8px 0; 
            font-size: 15px; 
            color: #2c3e50;
        }
        .file-info strong { 
            color: #3498db; 
        }
        .btn-change { 
            color: #e74c3c; 
            text-decoration: underline; 
            cursor: pointer; 
            font-size: 14px; 
            background: none; 
            border: none; 
            padding: 8px 12px;
            margin-top: 15px;
            border-radius: 6px;
            transition: all 0.3s;
        }
        .btn-change:hover { 
            color: #c0392b; 
            background: #f8f9fa;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ */
        .btn { 
            display: inline-block; 
            padding: 15px 40px; 
            color: white; 
            border-radius: 8px; 
            font-size: 18px; 
            font-weight: 600;
            cursor: pointer; 
            border: none; 
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .btn:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        .btn-upload { 
            background: linear-gradient(135deg, #28a745, #218838); 
        }
        .btn-upload:hover { 
            background: linear-gradient(135deg, #218838, #1e7e34); 
        }
        .btn-generate { 
            background: linear-gradient(135deg, #3498db, #2980b9); 
            width: 100%; 
            margin-top: 15px; 
        }
        .btn-generate:hover { 
            background: linear-gradient(135deg, #2980b9, #2573a7); 
        }
        .btn-generate:disabled { 
            background: #bdc3c7; 
            cursor: not-allowed; 
            transform: none;
            box-shadow: none;
        }
        
        /* –°—Å—ã–ª–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
        .back { 
            display: inline-block; 
            margin-bottom: 25px; 
            color: #3498db; 
            text-decoration: none; 
            font-weight: 600;
            font-size: 16px;
            padding: 8px 16px;
            border-radius: 6px;
            transition: background 0.3s;
        }
        .back:hover {
            background: #f8f9fa;
            color: #2980b9;
        }
        
        /* –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ñ–∞–π–ª—É */
        .requirements {
            background: #e7f3ff;
            padding: 25px;
            border-radius: 10px;
            margin: 30px 0;
            text-align: left;
            border-left: 4px solid #3498db;
        }
        .requirements h3 {
            margin-top: 0;
            color: #2c3e50;
            font-size: 20px;
        }
        .requirements ul {
            margin: 15px 0 0 0;
            padding-left: 25px;
        }
        .requirements li {
            margin: 8px 0;
            color: #2c3e50;
            font-size: 15px;
            line-height: 1.6;
        }
        .requirements strong {
            color: #3498db;
        }
        
        /* –ê–∫–∫–æ—Ä–¥–µ–æ–Ω - —à–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ–ª–µ–π */
        .accordion {
            width: 100%;
            margin: 20px 0;
            text-align: left;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }
        
        .accordion-header {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 16px 20px;
            cursor: pointer;
            font-weight: 600;
            font-size: 17px;
            color: #2c3e50;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #ddd;
            transition: all 0.3s;
        }
        
        .accordion-header:hover {
            background: #e9ecef;
            color: #3498db;
        }
        
        .accordion-header::after {
            content: '+';
            font-size: 24px;
            font-weight: bold;
            color: #3498db;
            transition: transform 0.3s;
        }
        
        .accordion-header.active::after {
            content: '‚àí';
            transform: rotate(180deg);
        }
        
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
            background: white;
            border: 1px solid #ddd;
            border-top: none;
        }
        
        .accordion-content.active {
            max-height: 1000px;
        }
        
        .accordion-inner {
            padding: 20px;
            max-height: 500px;
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        .fields-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-top: 10px;
        }
        
        .field-card {
            padding: 12px 15px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 3px solid #3498db;
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .field-card:hover {
            background: #e3f2fd;
            transform: translateX(5px);
        }
        
        .field-human {
            color: #2c3e50;
            font-weight: 600;
            flex: 1;
        }
        
        .field-code {
            color: #7f8c8d;
            font-weight: 400;
            font-size: 13px;
            margin-left: 15px;
            background: white;
            padding: 2px 8px;
            border-radius: 4px;
            border: 1px solid #e1e5eb;
            white-space: nowrap;
            flex-shrink: 0;
        }
        
        .tip-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-top: 15px;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .tip-box strong {
            color: #856404;
        }
        
        .hidden { 
            display: none; 
        }
    </style>
</head>
<body>
    <a href="/" class="back">‚Üê –ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É —Ä–µ–∂–∏–º–∞</a>
    
    <div class="form-container">
        <h1>üìÅ –ü–∞–∫–µ—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</h1>

        <form method="POST" action="/batch" enctype="multipart/form-data" id="upload-form">
            <!-- –û–±–ª–∞—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ -->
            <div class="upload-area" id="upload-area">
                <p style="font-size: 20px; font-weight: 600;">üìÅ –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ CSV –∏–ª–∏ XLSX —Ñ–∞–π–ª —Å—é–¥–∞</p>
                <p style="font-size: 14px; color: #7f8c8d; margin-top: 10px;">–ò–ª–∏</p>
                <button type="button" class="btn btn-upload" id="select-file-btn">–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª</button>
                <input type="file" id="file-input" name="file" accept=".csv,.xlsx,.xls" style="display:none;">
            </div>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–º —Ñ–∞–π–ª–µ -->
            <div class="file-info" id="file-info">
                <h3>
                    <span>‚úÖ –§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω</span>
                </h3>
                <p><strong>–ù–∞–∑–≤–∞–Ω–∏–µ:</strong> <span id="file-name">-</span></p>
                <p><strong>–†–∞–∑–º–µ—Ä:</strong> <span id="file-size">-</span></p>
                <p><strong>–§–æ—Ä–º–∞—Ç:</strong> <span id="file-type">-</span></p>
                <button type="button" class="btn-change" id="change-file-btn">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥—Ä—É–≥—É—é —Ç–∞–±–ª–∏—Ü—É</button>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ -->
            <button type="submit" class="btn btn-generate" id="generate-btn" disabled>
                üöÄ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
            </button>
        </form>

        <!-- –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ñ–∞–π–ª—É (–≤–æ–∑–≤—Ä–∞—â—ë–Ω!) -->
        <div class="requirements">
            <h3>üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ñ–∞–π–ª—É:</h3>
            <ul>
                <li>–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–ª–æ–Ω–æ–∫ (–¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –ø–æ–ª–µ–π)</li>
                <li>–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ = –æ–¥–∏–Ω –¥–æ–∫—É–º–µ–Ω—Ç</li>
                <li>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç—ã: <strong>.csv</strong>, <strong>.xlsx</strong>, <strong>.xls</strong></li>
                <li>–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞: <strong>UTF-8</strong></li>
                <li><a href="/example-csv" style="color:#3498db; text-decoration:underline;">–°–∫–∞—á–∞—Ç—å —à–∞–±–ª–æ–Ω CSV</a> | <a href="/example-xlsx" style="color:#3498db; text-decoration:underline;">–°–∫–∞—á–∞—Ç—å —à–∞–±–ª–æ–Ω XLSX</a></li>
            </ul>
        </div>

        <!-- –ê–∫–∫–æ—Ä–¥–µ–æ–Ω —Å —à–ø–∞—Ä–≥–∞–ª–∫–æ–π –ø–æ–ª–µ–π -->
        <div class="accordion">
            <div class="accordion-header" id="accordion-header">
                üìã –°–ø–∏—Å–æ–∫ –ø–æ–ª–µ–π —à–∞–±–ª–æ–Ω–∞ (—à–ø–∞—Ä–≥–∞–ª–∫–∞ –¥–ª—è CSV/XLSX)
            </div>
            <div class="accordion-content" id="accordion-content">
                <div class="accordion-inner">
                    <div class="fields-grid">
                        {% for field, human_name in fields %}
                        <div class="field-card">
                            <span class="field-human">{{ human_name }}</span>
                            <span class="field-code">{{ field }}</span>
                        </div>
                        {% endfor %}
                    </div>
                    <div class="tip-box">
                        <strong>üí° –°–æ–≤–µ—Ç:</strong> –ü—Ä–∏ –ø–∞–∫–µ—Ç–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞–∫ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–ª–æ–Ω–æ–∫ –≤ CSV/XLSX —Ñ–∞–π–ª–µ. –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Ñ–∞–π–ª–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ–ª–µ–π.
                    </div>
                    <p style="margin-top: 15px; text-align: center;">
                        <a href="/example-csv" class="btn" style="background: #3498db; padding: 8px 20px; font-size: 14px; margin-right: 10px; display: inline-block;">üì• –°–∫–∞—á–∞—Ç—å —à–∞–±–ª–æ–Ω CSV</a>
                        <a href="/example-xlsx" class="btn" style="background: #27ae60; padding: 8px 20px; font-size: 14px; display: inline-block;">üì• –°–∫–∞—á–∞—Ç—å —à–∞–±–ª–æ–Ω XLSX</a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const fileInput = document.getElementById('file-input');
        const uploadArea = document.getElementById('upload-area');
        const fileInfo = document.getElementById('file-info');
        const fileName = document.getElementById('file-name');
        const fileSize = document.getElementById('file-size');
        const fileType = document.getElementById('file-type');
        const generateBtn = document.getElementById('generate-btn');
        const changeFileBtn = document.getElementById('change-file-btn');
        
        // –ê–∫–∫–æ—Ä–¥–µ–æ–Ω
        const accordionHeader = document.getElementById('accordion-header');
        const accordionContent = document.getElementById('accordion-content');

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞
        accordionHeader.addEventListener('click', () => {
            accordionHeader.classList.toggle('active');
            accordionContent.classList.toggle('active');
        });

        // –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ "–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª"
        document.getElementById('select-file-btn').addEventListener('click', () => {
            fileInput.click();
        });

        // –ö–ª–∏–∫ –ø–æ –æ–±–ª–∞—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏
        uploadArea.addEventListener('click', () => {
            fileInput.click();
        });

        // –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.style.borderColor = '#218838';
            uploadArea.style.backgroundColor = '#f0fff0';
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.style.borderColor = '#28a745';
            uploadArea.style.backgroundColor = '#f8fff8';
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.style.borderColor = '#28a745';
            uploadArea.style.backgroundColor = '#f8fff8';
            
            if (e.dataTransfer.files.length) {
                fileInput.files = e.dataTransfer.files;
                handleFileSelect();
            }
        });

        // –í—ã–±–æ—Ä —Ñ–∞–π–ª–∞
        fileInput.addEventListener('change', handleFileSelect);

        function handleFileSelect() {
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ
                fileName.textContent = file.name;
                fileSize.textContent = formatFileSize(file.size);
                fileType.textContent = getFileExtension(file.name);
                
                // –°–∫—Ä—ã–≤–∞–µ–º –æ–±–ª–∞—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                uploadArea.classList.add('hidden');
                fileInfo.style.display = 'block';
                
                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
                generateBtn.disabled = false;
            }
        }

        // –ö–Ω–æ–ø–∫–∞ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥—Ä—É–≥—É—é —Ç–∞–±–ª–∏—Ü—É"
        changeFileBtn.addEventListener('click', () => {
            // –û—á–∏—â–∞–µ–º –∏–Ω–ø—É—Ç
            fileInput.value = '';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–±–ª–∞—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏, —Å–∫—Ä—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            uploadArea.classList.remove('hidden');
            fileInfo.style.display = 'none';
            
            // –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
            generateBtn.disabled = true;
        });

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' –±–∞–π—Ç';
            else if (bytes < 1048576) return (bytes / 1024).toFixed(1) + ' –ö–ë';
            else return (bytes / 1048576).toFixed(1) + ' –ú–ë';
        }

        function getFileExtension(filename) {
            return filename.split('.').pop().toUpperCase();
        }
    </script>
</body>
</html>